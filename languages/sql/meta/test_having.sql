DROP DATABASE IF EXISTS retail_db;
		CREATE DATABASE retail_db;
		USE retail_db;

-- You are tasked with analyzing sales data from a retail database. The sales table contains columns sale_id, product_id, sale_date, and sale_amount. Write a SQL query to find products that have had more than 10 sales transactions, where the total sales amount exceeds $5000. Order the results by the total sales amount in descending order.

-- Create a sales table
CREATE TABLE sales (
    sale_id INT PRIMARY KEY AUTO_INCREMENT,
    product_id INT,
    sale_date DATE,
    sale_amount DECIMAL(10, 2)
);

-- Insert sample data into the sales table
INSERT INTO sales (product_id, sale_date, sale_amount)
VALUES
    (101, '2023-01-01', 100.00),
    (102, '2023-01-01', 150.00),
    (101, '2023-01-02', 200.00),
    (103, '2023-01-03', 50.00),
    (102, '2023-01-03', 300.00),
    (101, '2023-01-04', 150.00),
    (104, '2023-01-05', 200.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-06', 100.00),
    (102, '2023-01-06', 150.00),
    (101, '2023-01-07', 250.00),
    (103, '2023-01-07', 100.00),
    (102, '2023-01-08', 200.00),
    (101, '2023-01-08', 300.00),
    (104, '2023-01-09', 150.00),
    (102, '2023-01-10', 100.00),
    (101, '2023-01-10', 200.00),
    (103, '2023-01-11', 300.00),
    (102, '2023-01-12', 250.00),
    (101, '2023-01-13', 150.00),
    (104, '2023-01-14', 200.00);


SELECT 
    product_id,
    COUNT(*) AS num_sales,
    SUM(sale_amount) AS total_sales_amount
FROM 
    sales
GROUP BY 
    product_id
HAVING 
    COUNT(*) > 10
    AND SUM(sale_amount) > 5000;
